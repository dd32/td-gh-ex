"undefined"==typeof window.panels&&(window.panels={});
jQuery(function(a){a("#panels-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,resizable:!1,draggable:!1,modal:!0,title:a("#panels-dialog").attr("data-title"),minWidth:960,close:function(){a("#panels-container .panel.new-panel").hide().fadeIn("slow").removeClass("new-panel")}}).find(".panel-type").disableSelection();a("#panels .panels-add").button({icons:{primary:"ui-icon-add"},text:!1}).click(function(){a("#panels-text-filter-input").val("").keyup();a("#panels-dialog").dialog("open");
return!1});var l=0;window.panels.createPanel=function(b,e){var d;d="string"==typeof b?a('#panels-dialog .panel-type[data-class="'+b+'"]'):b;if(0==d.length)return null;var f=a('<div class="panel new-panel"><div class="panel-wrapper"><h4></h4><small class="description"></small><div class="form"></div></div></div>'),g,h=d.attr("data-form"),h=h.replace(/\{\$id\}/g,l++);f.data({"title-field":d.attr("data-title-field"),title:d.attr("data-title")}).find("h4").click(function(){g.dialog("open")}).end().find(".description").html(d.find(".description").html()).end().find(".form").html(h);
var j={};j[panelsLoc.buttons["delete"]]=function(){confirm(panelsLoc.messages.confirmDeleteWidget)&&(f.fadeOut(function(){a(this).remove();a("#panels-container .panels-container").trigger("refreshcells")}),g.dialog("close"))};j[panelsLoc.buttons.done]=function(){a(this).trigger("panelsdone");g.find("*[name]").not("[data-info-field]").each(function(){var b=f.find('.form *[name="'+a(this).attr("name")+'"]');"checkbox"==b.attr("type")?b.prop("checked",a(this).is(":checked")):b.val(a(this).val())});k(f);
g.dialog("close")};g=a('<div class="dialog-form"></div>').html(h).dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,modal:!0,title:"Edit %s Panel".replace("%s",d.attr("data-title")),minWidth:700,create:function(){a(this).closest(".ui-dialog").find(".ui-dialog-buttonset button").eq(0).addClass("button-delete")},open:function(){f.find(".form *[name]").not("[data-info-field]").each(function(){var b=g.find('*[name="'+a(this).attr("name")+'"]');"checkbox"==b.attr("type")?b.prop("checked",a(this).is(":checked")):
b.val(a(this).val())});a(this).trigger("panelsopen")},buttons:j});g.find("label").each(function(){var b=a("#"+a(this).attr("for"));a(this).disableSelection();a(this).click(function(){"checkbox"==b.attr("type")?b.prop("checked",!b.prop("checked")):b.focus()})});f.disableSelection();if(void 0!=e)for(c in e)"info"!=c&&(d=f.find('.form *[name$="['+c+']"]'),h=g.find('*[name$="['+c+']"]'),"checkbox"==d.attr("type")?(d.prop("checked",Boolean(e[c])),h.prop("checked",Boolean(e[c]))):(d.val(e[c]),h.val(e[c])));
k(f);a(window).resize();return f};window.panels.addPanel=function(b){a("#panels-container .cell .panels-container").last().append(b);a("#panels-container .cell .panels-container").sortable("refresh").trigger("refreshcells");window.panels.resizeCells(a("#panels-container .cell .panels-container").last().closest(".grid-container"));a("#panels-container .panel.new-panel").hide().fadeIn("slow").removeClass("new-panel")};var k=function(a){var e=a.data("title-field"),d;void 0!=e&&(d=a.find('*[name$="['+
e+']"]').val());""==d||void 0==d?a.find("h4").html(a.data("title")):a.find("h4").html(a.data("title")+": "+d)};a("#panels-text-filter-input").keyup(function(){var b=a(this).val();a("#panels-dialog .panel-type-list .panel-type").show().each(function(){""!=b&&-1==a(this).find("h3").html().toLowerCase().indexOf(b)&&a(this).hide()})}).click(function(){a(this).keyup()});a("#panels-dialog .panel-type").click(function(){var b=window.panels.createPanel(a(this));window.panels.addPanel(b);a("#panels-dialog").dialog("close")});
window.panels.loadPanels=function(b){window.panels.clearGrids();for(var e in b.grids){var d=[],f;for(f in b.grid_cells)Number(b.grid_cells[f].grid)==e&&(d[d.length]=Number(b.grid_cells[f].weight));d=window.panels.createGrid(Number(b.grids[e].cells),d);window.panels.setupGrid(d);for(var g in b.widgets)if(Number(b.widgets[g].info.grid)==e){var h=b.widgets[g],h=window.panels.createPanel(h.info["class"],h);d.find(".panels-container").eq(Number(b.widgets[g].info.cell)).append(h)}}a("#panels-container .panels-container").sortable("refresh").trigger("refreshcells");
a("#panels-container .panel").removeClass("new-panel");a("#panels-container .grid-container").each(function(){window.panels.resizeCells(a(this))})};"undefined"!=typeof panelsData?window.panels.loadPanels(panelsData):window.panels.setupGrid(window.panels.createGrid(1));a(window).resize(function(){a(".panels-admin-dialog").filter(":data(dialog)").dialog("option","position","center")});a("#wp-content-editor-tools").find(".wp-switch-editor").click(function(){a("#wp-content-editor-container, #post-status-info").show();
a("#so-panels-panels").hide();a("#content-panels").removeClass("panels-tab-active");var b=this;switchEditors.go("content","toggle");switchEditors.switchto(b);setTimeout(function(){switchEditors.go("content","toggle");switchEditors.switchto(b)},100);return!1}).end().prepend(a('<a id="content-panels" class="hide-if-no-js wp-switch-editor switch-panels">'+a("#so-panels-panels h3.hndle span").html()+"</a>").click(function(){a(this);a("#wp-content-wrap").removeClass("tmce-active html-active");a("#wp-content-editor-container, #post-status-info").hide();
a("#so-panels-panels").show();a("#content-panels").addClass("panels-tab-active");a(window).resize()}));"undefined"!=typeof panelsData&&setTimeout(function(){a("#content-panels").click()},50);setTimeout(function(){a("#so-panels-panels .hndle").unbind("click")},500);a("#so-panels-panels").insertAfter("#wp-content-editor-container").addClass("wp-editor-container").hide().find(".handlediv").remove()});