!function(e,t,s){e.fn.tinyNav=function(a){var i=e.extend({active:"selected",header:"",indent:"- ",label:""},a);return this.each(function(){s++;var a=e(this),n="tinynav"+s,l=".l_"+n,o=e("<select/>").attr("id",n).addClass("tinynav "+n);if(a.is("ul,ol")){""!==i.header&&o.append(e("<option/>").text(i.header));var c="";a.addClass("l_"+n).find("a").each(function(){var t;for(c+='<option value="'+e(this).attr("href")+'">',t=0;t<e(this).parents("ul, ol").length-1;t++)c+=i.indent;c+=e(this).text()+"</option>"}),o.append(c),i.header||o.find(":eq("+e(l+" li").index(e(l+" li."+i.active))+")").attr("selected",!0),o.change(function(){t.location.href=e(this).val()}),e(l).after(o),i.label&&o.before(e("<label/>").attr("for",n).addClass("tinynav_label "+n+"_label").append(i.label))}})}}(jQuery,this,0),function(e,t){var s=!0;function a(){this._state=[],this._defaults={classHolder:"sb-holder",classHolderDisabled:"sb-holder-disabled",classSelector:"sb-selector",classOptions:"sb-options",classGroup:"sb-group",classSub:"sb-sub",classDisabled:"sb-disabled",classToggleOpen:"sb-toggle-open",classToggle:"sb-toggle",classFocus:"sb-focus",speed:200,effect:"slide",onChange:null,onOpen:null,onClose:null}}e.extend(a.prototype,{_isOpenSelectbox:function(e){return!!e&&this._getInst(e).isOpen},_isDisabledSelectbox:function(e){return!!e&&this._getInst(e).isDisabled},_attachSelectbox:function(t,a){if(this._getInst(t))return!1;var i,n,l,o,c=e(t),d=this,r=d._newInst(c),u=!1,p=(c.find("optgroup"),c.find("option")),b=p.length;function g(){var t,s,a=this.attr("id").split("_")[1];for(t in d._state)t!==a&&d._state.hasOwnProperty(t)&&(s=e("select[sb='"+t+"']")[0])&&d._closeSelectbox(s)}function h(){var a=!(!arguments[1]||!arguments[1].sub),i=!(!arguments[1]||!arguments[1].disabled);arguments[0].each(function(c){var p,g=e(this),h=e("<li>");g.is(":selected")&&(n.text(g.text()),u=s),c===b-1&&h.addClass("last"),g.is(":disabled")||i?(p=e("<span>",{text:g.text()}).addClass(r.settings.classDisabled),a&&p.addClass(r.settings.classSub),p.appendTo(h)):(p=e("<a>",{href:g.val(),rel:g.val()}).text(g.text()).bind("click.sb",function(s){s&&s.preventDefault&&s.preventDefault();var a=l,i=e(this);a.attr("id").split("_")[1];d._changeSelectbox(t,i.attr("rel"),i.text()),d._closeSelectbox(t)}).bind("mouseover.sb",function(){var t=e(this);t.parent().siblings().find("a").removeClass(r.settings.classFocus),t.addClass(r.settings.classFocus)}).bind("mouseout.sb",function(){e(this).removeClass(r.settings.classFocus)}),a&&p.addClass(r.settings.classSub),g.is(":selected")&&p.addClass(r.settings.classFocus),p.appendTo(h)),h.appendTo(o)})}c.attr("sb",r.uid),e.extend(r.settings,d._defaults,a),d._state[r.uid]=!1,c.hide(),i=e("<div>",{id:"sbHolder_"+r.uid,class:r.settings.classHolder,tabindex:c.attr("tabindex")}),n=e("<a>",{id:"sbSelector_"+r.uid,href:"#",class:r.settings.classSelector,click:function(s){s.preventDefault(),g.apply(e(this),[]);var a=e(this).attr("id").split("_")[1];d._state[a]?d._closeSelectbox(t):d._openSelectbox(t)}}),(l=e("<a>",{id:"sbToggle_"+r.uid,href:"#",class:r.settings.classToggle,click:function(s){s.preventDefault(),g.apply(e(this),[]);var a=e(this).attr("id").split("_")[1];d._state[a]?d._closeSelectbox(t):d._openSelectbox(t)}})).appendTo(i),o=e("<ul>",{id:"sbOptions_"+r.uid,class:r.settings.classOptions,css:{display:"none"}}),c.children().each(function(t){var s,a=e(this),i={};a.is("option")?h(a):a.is("optgroup")&&(s=e("<li>"),e("<span>",{text:a.attr("label")}).addClass(r.settings.classGroup).appendTo(s),s.appendTo(o),a.is(":disabled")&&(i.disabled=!0),i.sub=!0,h(a.find("option"),i))}),u||n.text(p.first().text()),e.data(t,"selectbox",r),i.data("uid",r.uid).bind("keydown.sb",function(t){var s=t.charCode?t.charCode:t.keyCode?t.keyCode:0,a=e(this),i=a.data("uid"),n=a.siblings("select[sb='"+i+"']").data("selectbox"),l=a.siblings(["select[sb='",i,"']"].join("")).get(0),o=a.find("ul").find("a."+n.settings.classFocus);switch(s){case 37:case 38:if(o.length>0)e("a",a).removeClass(n.settings.classFocus),(c=o.parent().prevAll("li:has(a)").eq(0).find("a")).length>0&&(c.addClass(n.settings.classFocus).focus(),e("#sbSelector_"+i).text(c.text()));break;case 39:case 40:var c;e("a",a).removeClass(n.settings.classFocus),(c=o.length>0?o.parent().nextAll("li:has(a)").eq(0).find("a"):a.find("ul").find("a").eq(0)).length>0&&(c.addClass(n.settings.classFocus).focus(),e("#sbSelector_"+i).text(c.text()));break;case 13:o.length>0&&d._changeSelectbox(l,o.attr("rel"),o.text()),d._closeSelectbox(l);break;case 9:if(l)(n=d._getInst(l))&&(o.length>0&&d._changeSelectbox(l,o.attr("rel"),o.text()),d._closeSelectbox(l));var r=parseInt(a.attr("tabindex"),10);t.shiftKey?r--:r++,e("*[tabindex='"+r+"']").focus();break;case 27:d._closeSelectbox(l)}return t.stopPropagation(),!1}).delegate("a","mouseover",function(t){e(this).addClass(r.settings.classFocus)}).delegate("a","mouseout",function(t){e(this).removeClass(r.settings.classFocus)}),n.appendTo(i),o.appendTo(i),i.insertAfter(c),e("html").on("mousedown",function(t){t.stopPropagation(),e("select").selectbox("close")}),e([".",r.settings.classHolder,", .",r.settings.classSelector].join("")).mousedown(function(e){e.stopPropagation()})},_detachSelectbox:function(t){var s=this._getInst(t);if(!s)return!1;e("#sbHolder_"+s.uid).remove(),e.data(t,"selectbox",null),e(t).show()},_changeSelectbox:function(t,a,i){var n,l=this._getInst(t);l&&(n=this._get(l,"onChange"),e("#sbSelector_"+l.uid).text(i)),a=a.replace(/\'/g,"\\'"),e(t).find("option[value='"+a+"']").attr("selected",s),l&&n?n.apply(l.input?l.input[0]:null,[a,l]):l&&l.input&&l.input.trigger("change")},_enableSelectbox:function(t){var s=this._getInst(t);if(!s||!s.isDisabled)return!1;e("#sbHolder_"+s.uid).removeClass(s.settings.classHolderDisabled),s.isDisabled=!1,e.data(t,"selectbox",s)},_disableSelectbox:function(t){var a=this._getInst(t);if(!a||a.isDisabled)return!1;e("#sbHolder_"+a.uid).addClass(a.settings.classHolderDisabled),a.isDisabled=s,e.data(t,"selectbox",a)},_optionSelectbox:function(t,s,a){var i=this._getInst(t);if(!i)return!1;i[s]=a,e.data(t,"selectbox",i)},_openSelectbox:function(t){var a=this._getInst(t);if(a&&!a.isOpen&&!a.isDisabled){var i=e("#sbOptions_"+a.uid),n=parseInt(e(window).height(),50),l=e("#sbHolder_"+a.uid).offset(),o=e(window).scrollTop(),c=i.prev().height(),d=n-(l.top-o)-c/2,r=this._get(a,"onOpen");i.css({top:c+"px",maxHeight:d-c+"px"}),"fade"===a.settings.effect?i.fadeIn(a.settings.speed):i.slideDown(a.settings.speed),e("#sbToggle_"+a.uid).addClass(a.settings.classToggleOpen),this._state[a.uid]=s,a.isOpen=s,r&&r.apply(a.input?a.input[0]:null,[a]),e.data(t,"selectbox",a)}},_closeSelectbox:function(t){var s=this._getInst(t);if(s&&s.isOpen){var a=this._get(s,"onClose");"fade"===s.settings.effect?e("#sbOptions_"+s.uid).fadeOut(s.settings.speed):e("#sbOptions_"+s.uid).slideUp(s.settings.speed),e("#sbToggle_"+s.uid).removeClass(s.settings.classToggleOpen),this._state[s.uid]=!1,s.isOpen=!1,a&&a.apply(s.input?s.input[0]:null,[s]),e.data(t,"selectbox",s)}},_newInst:function(e){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,uid:Math.floor(99999999*Math.random()),isOpen:!1,isDisabled:!1,settings:{}}},_getInst:function(t){try{return e.data(t,"selectbox")}catch(e){throw"Missing instance data for this selectbox"}},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]}}),e.fn.selectbox=function(t){var s=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&"isDisabled"==t?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this[0]].concat(s)):"option"==t&&2==arguments.length&&"string"==typeof arguments[1]?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this[0]].concat(s)):this.each(function(){"string"==typeof t?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this].concat(s)):e.selectbox._attachSelectbox(this,t)})},e.selectbox=new a,e.selectbox.version="0.2"}(jQuery),jQuery(".menu").tinyNav({active:"current-menu-item",header:""}),jQuery(function(){jQuery(".tinynav").selectbox()}),jQuery(document).ready(function(){jQuery(".menu-item").has("ul").children("a").attr("aria-haspopup","true")});
